---
import project from "../data/project.json";
import client from "../../tina/__generated__/client";

const projectCount = project.projects.length;

// Get blog count
let blogCount = 0;
try {
  const resp = await client.queries.postConnection();
  blogCount = resp.data.postConnection?.edges?.length ?? 0;
} catch (e) {
  blogCount = 0;
}
---

<div class="twitter-profile-info">
  <div class="twitter-profile-header">
    <div>
      <h1 class="twitter-display-name">Nanda Kresnatara</h1>
      <p class="twitter-handle">@taradevio</p>
    </div>
    <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
      <svg
        class="sun-icon"
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41l-1.06-1.06zm1.06-10.96c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"
        ></path>
      </svg>
      <svg
        class="moon-icon"
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"
        ></path>
      </svg>
    </button>
  </div>

  <p class="twitter-bio">
    Frontend Developer with a background in English Literature. Building
    functional and user-friendly web experiences, turning ideas into reality
    through code.
  </p>

  <div class="twitter-meta">
    <span class="twitter-meta-item">
      <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path
          d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"
        ></path>
      </svg>
      Indonesia
    </span>
    <a
      href="https://github.com/taradevio"
      target="_blank"
      class="twitter-meta-item"
      style="color: var(--twitter-blue);"
    >
      <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path
          d="M11.96 2C6.45 2 2 6.45 2 11.96s4.45 9.96 9.96 9.96c5.51 0 9.96-4.45 9.96-9.96S17.47 2 11.96 2zm6.23 6.55h-2.45c.25 1.72.41 3.6.41 5.45 0 1.85-.16 3.73-.41 5.45h2.45c.7-1.64 1.09-3.5 1.09-5.45s-.39-3.81-1.09-5.45zm-6.23 12.77c-1.06-1.35-1.91-3.92-2.21-7.32h4.43c-.3 3.4-1.16 5.97-2.22 7.32zM9.52 12c0-1.89.16-3.65.41-5.45h4.14c.25 1.8.41 3.56.41 5.45s-.16 3.65-.41 5.45H9.93c-.25-1.8-.41-3.56-.41-5.45zm2.44-9.32c1.06 1.35 1.92 3.92 2.22 7.32H9.75c.3-3.4 1.16-5.97 2.21-7.32zM8.16 8.55H5.71c-.7 1.64-1.09 3.5-1.09 5.45s.39 3.81 1.09 5.45h2.45c-.25-1.72-.41-3.6-.41-5.45 0-1.85.16-3.73.41-5.45zm-.32-1.68c-.67 1.58-1.05 3.41-1.05 5.13h-2.6c.43-2.3 1.64-4.29 3.34-5.68l.31.55zm.32 12.26c-.25 1.75-.41 3.63-.41 5.47h-2.6c-.43-2.3-1.64-4.29-3.34-5.68l.31.55h2.45c.25 1.75.41 3.63.41 5.47v-.34z"
        ></path>
      </svg>
      github.com/taradevio
    </a>
  </div>

  <div class="twitter-stats">
    <span class="twitter-stat">
      <span class="twitter-stat-number">{projectCount}</span> Projects
    </span>
    <span class="twitter-stat">
      <span class="twitter-stat-number">{blogCount}</span> Blog Posts
    </span>
  </div>
</div>

<script is:inline>
  // Theme Toggle Script
  (function () {
    const toggle = document.getElementById("theme-toggle");
    const html = document.documentElement;

    // Get saved theme or system preference
    const getPreferredTheme = () => {
      const saved = localStorage.getItem("theme");
      if (saved) return saved;
      return window.matchMedia("(prefers-color-scheme: dark)").matches
        ? "dark"
        : "light";
    };

    // Apply theme
    const applyTheme = (theme) => {
      html.setAttribute("data-theme", theme);
      localStorage.setItem("theme", theme);
    };

    // Initialize
    applyTheme(getPreferredTheme());

    // Toggle handler
    if (toggle) {
      toggle.addEventListener("click", () => {
        const current = html.getAttribute("data-theme");
        applyTheme(current === "dark" ? "light" : "dark");
      });
    }

    // Listen for system theme changes
    window
      .matchMedia("(prefers-color-scheme: dark)")
      .addEventListener("change", (e) => {
        if (!localStorage.getItem("theme")) {
          applyTheme(e.matches ? "dark" : "light");
        }
      });
  })();
</script>
